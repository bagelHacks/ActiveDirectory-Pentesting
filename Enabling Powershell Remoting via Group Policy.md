# Enabling Powershell Remoting via Group Policy

Powershell remoting is a windows feature that allows specified Administrators to manage remote systems. This is also a common lateral movement technique. I was craving some sysad and thought it would be good to configure this. 

In my testing environment, I hopped to the Domain Controller and opened up Group Policy Management. This is where GPO's are configured which are policies that are applied to object's or OU's which are groups of objects. I will create a GPO that will be applied to all user computers in the domain. This GPO will enable powershell remoting on those systems.

Right click Domain and select "Create GPO..."

![[Pasted image 20210906165800.png]]

Name the GPO 

![[Pasted image 20210906171427.png]]

Navigate to Computer Configuration > Administrative Templates > Windows Components > Windows Remote Management (WinRM) > WinRMService

![[Pasted image 20210906170347.png]]

Enable to following option

![[Pasted image 20210906170557.png]]

![[Pasted image 20210906170723.png]]

The description reads "To allow WinRM service to receive requests over the network, configure the Windows Firewall policy setting with exceptions for Port 5985 (default port for HTTP).
" 

This means, part of this GPO will also require opening Windows Remote Management to the local firewall policy.

Navigate to Computer Configuration > Policies > Windows Settings > Windows Defender Firewall > Inbound Rules

![[Pasted image 20210906171033.png]]

Create a new rule

![[Pasted image 20210906171106.png]]

Next, apply the GPO to the Domain Computer's group

![[Pasted image 20210906174530.png]]

Now anybody in the Domain Admins group can use powershell remoting manage systems remotely. 

jhalpert is in the Domain Admins group and can execute commands on Pam-computer

![[Pasted image 20210906185737.png]]

From Pam's Computer, I looked at the security event logs which resulted in a brief 4624 and 4625

![[Pasted image 20210906190322.png]]

![[Pasted image 20210906190417.png]]