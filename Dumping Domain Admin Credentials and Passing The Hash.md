# Dumping Domain Admin Hash and Passing The Hash

This lab will demonstrate how a threat actor may be able to dump Domain Admin hashes from a compromised system. Defender is turned off. 


Scenario: Bad guy compromised the user dchrute's computer and is able to escalate privileges. Earlier in the day, jhalpert, a domain admin was logged into dchrute's computer for maintenance. 

## Dump LSASS memory with Invoke-Mimikatz.ps1 

Invoke-Mimikatz -dumpcreds

![[Pasted image 20210907122053.png]]

Now, with the hash I can use mimikatz pass it and spawn a shell with Domain Admin privileges

Invoke-mimikatz -Command '"sekurlsa::pth /ntlm:9e7c6b33d9a2dfc1c9aef53eb2837b32 /user:jhalpert /domain:DUNDER-MIFFLIN /run:powershell.exe "'

![[Pasted image 20210907122657.png]]

I was able to list the C$ share on the domain controller which means admin privileges.

![[Pasted image 20210907122836.png]]

## Caveats
- Windows Defender was turned off. For this to work, mimikatz would need to be modified to avoid AV
- dschrute had local admin privileges on his machine. This makes it easy to dump credentials. In a real world scenario, the after gaining a foot hold the adversary must first escalate privileges. 
- If Jhalpert did not login to dschrutes machine earlier, the actor would not be able to dump the necessary credentials. 
