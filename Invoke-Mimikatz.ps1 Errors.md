# Invoke-Mimikatz.ps1 Errors

Invoke-Mimikatz is a powershell script that can be used to dump credentials from lsass (LocalSecurityAuthority) memory . This can also dump local credentials from the SAM registry.

### ERROR kuhl_m_sekurlsa_acquireLSA ; Handle on memory (0x00000005)**

![[Pasted image 20210906010910.png]]

**Reasons for this error:**
1. My current user does not have local admin
2. I am not running in an elevated shell
3. User Account Controle is enabled. This runs applications as a regular user, and will require a prompt everytime an application runs as SYSTEM

**In this case, I was not running in an elevated shell. I attempted the credential dump again with an admin level shell**

![[Pasted image 20210906011924.png]]


### ERROR kuhl_m_sekurlsa_acquireLSA ; Logon list

![[Pasted image 20210906012326.png]]

**Reasons for this error:**

1. Executing an old version of Mimikatz on a new Windows 10 machine.

### I downloaded a recent version of Mimikatz and was able to dump the lsass memory

![[Pasted image 20210906013223.png]]



## Detection

\#Command to read last 10 Security event logs

Get-EventLog -LogName Security -Newest 10

![[Pasted image 20210906015536.png]]


- The following windows events were triggered
- 4663 An attempt was made to access an object
- 4656 A handle to an object was requested
- 4658 The handle to an object was closed
- 4690 An attempt was made to duplicate a handle to an object
- 4688 A new process has been created