# PowerView CheatSheet

PowerView.ps1 is a powerful domain enumeration tool created by harmj0y. During my CRTP studies, I learned how to leverage this to enumerate AD objects such as user's, computers, domain trusts, GPO's, etc. 

## Commands

### Enumerate Users
Get-NetUser # Get all users of the domain

Get-NetUser | select cn,description # Get the description property of every user 

Get-NetUser -UserName dschrute # Get group's that user dschrute is a member of

Get-DomainUser -TrustedToAuth # (PowerView_dev) get users with constrained delegation enabled

### Enumerate Computers
Get-NetComputer # get all computers on the domain

Get-NetComputer -fulldata # display all properties to each computer object

Get-NetComputer -fulldata | select cn,operatingsystem # display the OS of each computer 

Get-NetComputer -Unconstrained # Find computers where unconstrained delegation is enabled

Get-DomainComputer -TrustedToAuth # (PowerView_dev) Get computers configured with constrained delegation


### Enumerate Groups
Get-NetGroup # Get all domain groups

Get-NetGroupMember "Domain Admins" # Get members of the Domain Admins group

### Enumerate Domains
Get-NetDomain # Get current domain

Get-NetdomainTrust # Get domain trusts

Get-NetUser -Domain Nashua.Dunder-Mifflin.local # Get Users from the Nashua child domain

Get-NetComputer -Domain Nashua.Dunder-Mifflin.local # Get computers in the Nashua child domain

### Find local admin access

Find-LocalAdminAccess # First queries DC for all computers, then checks if user can login locally

### Find SMB Shares

Invoke-ShareFinder -Verbose  # Get SMB shares in domain

Invoke-Share -CheckAccess 

Invoke-FileFinder # Find interesting files on smbshares

### Enumerate GPO's

get-netgpo | select displayname # Get GPO's

### Get ACL's

Get-ObjectAcl # Get all ACL's

Get-ObjectAcl | ? {$_.IdentityReference -eq "DUNDER-MIFFLIN\Domain Admins"} # Get ACL's for Domain Admins group

Get-ObjectAcl | ? {$_.ActiveDirectoryRights -eq "GenericAll"} # Get ACL's where rights "GenericAll" are enabled

Invoke-ACLScanner -ResolveGuids # pull interesting ACE's

### Find Sessions

Invoke-UserHunter # Find user sessions

Invoke-UserHunter -GroupName "RDPUsers" # Find sessions where the user is in the "RDPUsers" group

