# Password Spray Detection 

## Use Powershell to get all user accounts in the domain

I used DomainPasswordSpray.ps1 to do this attack

https://github.com/dafthack/DomainPasswordSpray

Invoke-DomainPasswordSpray -Password Password123!

![[Pasted image 20210907124432.png]]

The password of "Password123!" worked on the pbeesly and dschrute users.

Immediately after performing the password spary, I hopped to the DC and pulled the windows event logs. 

Get-WinEvent -LogName 'Security' | Select-Object -First 14

![[Pasted image 20210907124804.png]]

EventLogs Generated:
- 4625 - An account failed to log on
- 4776 - The computer attempted to validate the credentials
- 4624 - An account successfully logged on 

**The important event log is 4625**

![[Pasted image 20210907125946.png]]

![[Pasted image 20210907130013.png]]

![[Pasted image 20210907130033.png]]

![[Pasted image 20210907130047.png]]

## Detection

- Multiple 4625 events from the same workstation or Source Network Address
- Logon type 3 
- Within 1 minute

## Observations
- The 4624 logs from the DC were not related to the password spray. I did some research and 4624 logs are stored locally on the computer that was logged in. This means I would not see the 4624's from password spray on the DC. 