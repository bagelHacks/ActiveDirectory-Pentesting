# Password Spray Detection 

Password spraying is a common technique that authentication to multiple user's on a domian with a commonly used password. 

I used DomainPasswordSpray.ps1 to do this attack

https://github.com/dafthack/DomainPasswordSpray

Invoke-DomainPasswordSpray -Password Password123!

![image](https://user-images.githubusercontent.com/90155329/132384151-578d1772-73e2-4680-a8c2-e424543abaff.png)

The password of "Password123!" worked on the pbeesly and dschrute users.

Immediately after performing the password spary, I hopped to the DC and pulled the windows event logs. 

Get-WinEvent -LogName 'Security' | Select-Object -First 14

![image](https://user-images.githubusercontent.com/90155329/132384215-bc3a4274-65c9-4cfb-b62b-9aafcd0b3b16.png)

EventLogs Generated:
- 4625 - An account failed to log on
- 4776 - The computer attempted to validate the credentials
- 4624 - An account successfully logged on 

**The important event log is 4625**

![image](https://user-images.githubusercontent.com/90155329/132384255-35dc36ef-0802-4e60-a4bd-86152707b274.png)

![image](https://user-images.githubusercontent.com/90155329/132384302-5aa139d8-ce54-4abd-b2ec-f93bcf035b1f.png)

![image](https://user-images.githubusercontent.com/90155329/132384334-01423ece-ec92-4f22-aad7-d2ef4cc49093.png)

![image](https://user-images.githubusercontent.com/90155329/132384360-d65db273-457a-4cc5-9741-ef1a54d6d88b.png)

## Detection

- Multiple 4625 events from the same workstation or Source Network Address
- Logon type 3 
- Within 1 minute

## Observations
- The 4624 logs from the DC were not related to the password spray. I did some research and 4624 logs are stored locally on the computer that was logged in. This means I would not see the 4624's from password spray on the DC. 
